<!DOCTYPE html>
<html>
<head>
<style type="text/css">
	html,
body {
    height: 100%;
}

/* Scale canvas with resize attribute to full size */
canvas[resize] {
    width: 100%;
    height: 100%;
    background-color: "f8f8f8";
}
</style>
<!-- Load the Paper.js library -->
<script type="text/javascript" src="node_modules/paper/dist/paper-full.js"></script>
<!-- Define inlined PaperScript associate it with myCanvas -->
<script data-main="node_modules/suncalc/suncalc" src="node_modules/requirejs/require.js"></script>
<script type="text/javascript" src="js/init.js"></script>
<script type="text/javascript" src="js/alpha.js"></script>
<script type="text/javascript" src="js/time.js"></script>
</head>
<body>
    <section id="controls">
        <div id="inputelements">
            <div class="row">
                <span class="inputfield">
                    <label for="modeInput">Mode</label>
                    <select id="modeInput">
                        <option selected = "selected" value="startDay">start of day</option>
                        <option value="dawn">dawn</option>
                        <option value="sunrise">sunrise</option>
                        <option value="goldenHourEnd">golden hour end</option>
                        <option value="solarNoon">solar noon</option>
                        <option value="goldenHour">golden hour</option>
                        <option value="sunset">sunset</option>
                        <option value="dusk">dusk</option>
                        <option value="endDay">end of day</option>
                        <option value="time">time</option>
                    </select>
                </span>
            </div>
        </div>
    </section>
	<canvas id="myCanvas" resize></canvas>
    <script type="text/javascript">
        paper.install(window);
        window.onload = function() {
            paper.setup('myCanvas');
            /*--SET COORDINATES FOR TRAFFIC DENSITY DATA--*/
		    var coordinates = [40.7276, -73.9287];

            /*--TIME--*/
            var [NY_now, startOfDay, endOfDay] = updateTime()

            /*--GET MODE--*/
            var mode = document.getElementById("modeInput").value

            /*--SUNCALC--*/
		    var SunCalc = require('suncalc');
		    var solar = SunCalc.getTimes(NY_now, coordinates[0], coordinates[1]);

            /*--CONVERT MODE TO TIME --*/
            var solar_modes = {
                startDay: startOfDay,
                dawn: solar.dawn,
                sunrise: solar.sunrise,
                goldenHourEnd: solar.goldenHourEnd,
                solarNoon: solar.solarNoon,
                goldenHour: solar.goldenHour,
                sunset: solar.sunset,
                dusk: solar.dusk,
                endDay: endOfDay,
                time: NY_now
            }

            /*--BODY COLOR--*/
            var body = getBodyFromMode(solar_modes[mode], solar)
            var bg_rect = update_bg_gradient(body)

            var solarColor = getSolarColor(solar_modes[mode], solar, startOfDay, endOfDay)
            var solar_rect = update_solar(solarColor)
            
            function modeSelect(){
                mode = this.value;
                body = getBodyFromMode(solar_modes[mode], solar)
                bg_rect = update_bg_gradient(body)

                var solarColor = getSolarColor(solar_modes[mode], solar, startOfDay, endOfDay)
                var solar_rect = update_solar(solarColor)
            }
            document.getElementById("modeInput").onchange = modeSelect
        }
    </script>
</body>
</html>